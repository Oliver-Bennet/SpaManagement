{% extends 'layout/base.html' %}

{% block content %}
<div class="container py-4">

    <!-- TI√äU ƒê·ªÄ -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h3 class="fw-bold mb-1">
                üìÖ L·ªãch ƒë·∫∑t h·∫πn
            </h3>
            <p class="text-muted mb-0">
                Th√°ng {{ selected_date.month }}, {{ selected_date.year }}
            </p>
        </div>
    </div>

    <!-- THANH CH·ªåN NG√ÄY -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <div class="d-flex flex-wrap gap-3 fs-5">
                {% for d in days %}
                <a href="/receptionist/calendar?date={{ d.strftime('%Y-%m-%d') }}"
                   class="text-decoration-none
                       {% if d == selected_date %}
                           fw-bold text-white bg-primary px-3 py-1 rounded
                       {% else %}
                           text-dark
                       {% endif %}">
                    {{ d.day }}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- NG√ÄY ƒêANG XEM -->
    <h5 class="mb-3">
        {{ selected_date.strftime('%d/%m/%Y') }}
        {% if selected_date == selected_date.today() %}
        <span class="badge bg-success ms-2">H√¥m nay</span>
        {% endif %}
    </h5>

    <!-- L·ªäCH THEO GI·ªú -->
    <div class="card shadow-sm">
        <div class="card-body">

            {% for time, app in schedule.items() %}
            <div class="row align-items-center py-2 border-bottom">

                <!-- GI·ªú -->
                <div class="col-2 fw-bold text-muted">
                    ‚è∞ {{ time }}
                </div>

                {% set current_time = now().strftime('%H:%M') %}
                {% if app %}
                <!-- C√ì L·ªäCH -->
                <div class="col-6">
                    <div class="fw-bold">{{ app.customer }}</div>
                    <div class="text-muted small">
                        {{ app.service }} ‚Ä¢ KTV: {{ app.staff }}
                    </div>
                </div>

                <div class="col-4 text-end">
                    <a href="#" class="btn btn-outline-success btn-sm">
                        Check-in
                    </a>
                    <a href="#" class="btn btn-outline-primary btn-sm mx-1">
                        S·ª≠a
                    </a>
                    <a href="#" class="btn btn-outline-danger btn-sm">
                        H·ªßy
                    </a>
                </div>
                {% else %}
                {% if selected_date < today %}
                <span class="text-muted fst-italic">
                    ‚õî ƒê√£ qua ng√†y
                </span>

                {% elif selected_date == today and time <= current_time %}
                <span class="text-muted fst-italic">
                    ‚è∞ ƒê√£ qua gi·ªù
                </span>

                {% else %}
                <!-- KHUNG GI·ªú TR·ªêNG -->
                <div class="col-10">
                    <a class="btn btn-sm btn-success"
                       href="/receptionist/book?date={{ selected_date }}&time={{ time }}">
                        ‚ûï ƒê·∫∑t l·ªãch
                    </a>
                    <span class="text-muted ms-2">
                                (Ch∆∞a c√≥ kh√°ch)
                            </span>
                </div>
                {% endif %}
                {% endif %}
            </div>
            {% endfor %}

        </div>
    </div>

</div>
{% endblock %}